targets="slir"

defvars() {
	echo SLIR_SOURCES= ${input_base}/{interpret,logreader,addressspace,machinestate,interpreter,syscalls,transform_expr,replay}.cpp

	cat <<EOF
SLIR_OBJECTS=\$(patsubst %.cpp,%.o,\$(SLIR_SOURCES))
EOF
}

rules() {
    cat <<EOF
\$(SLIR_OBJECTS): sli/sli.h
\$(SLIR_OBJECTS): CPPFLAGS+=-I\$(libvex)/pub
${input_base}/interpreter.o: CPPFLAGS+=-I\$(libvex)/priv
${input_base}/logreader.o: sli/ppres.h
${input_base}/interpreter.o: sli/ppres.h

slir.a: \$(SLIR_OBJECTS)
	ar rcs \$@ \$^

slir: slir.a libVEX.a
	gcc \$(PROFILE_FLAGS) -lstdc++ \$^ -o \$@
EOF
}